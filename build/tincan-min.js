
/*!
    Copyright 2012 Rustici Software

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
*/
;var TinCan;(function(){"use strict";var a={statementId:!0,voidedStatementId:!0,verb:!0,object:!0,registration:!0,context:!0,actor:!0,since:!0,until:!0,limit:!0,authoritative:!0,sparse:!0,instructor:!0,ascending:!0,continueToken:!0,agent:!0,activityId:!0,stateId:!0,profileId:!0,activity_platform:!0,grouping:!0,"Accept-Language":!0};TinCan=function(a){this.log("constructor"),this.recordStores=[],this.actor=null,this.activity=null,this.registration=null,this.context=null,this.init(a)},TinCan.prototype={LOG_SRC:"TinCan",log:function(a,b){TinCan.DEBUG&&typeof console!="undefined"&&console.log&&(b=b||this.LOG_SRC||"TinCan",console.log("TinCan."+b+": "+a))},init:function(a){this.log("init");var b;a=a||{},a.hasOwnProperty("url")&&a.url!==""&&this._initFromQueryString(a.url);if(a.hasOwnProperty("recordStores")&&a.recordStores!==undefined)for(b=0;b<a.recordStores.length;b+=1)this.addRecordStore(a.recordStores[b]);a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity)),a.hasOwnProperty("actor")&&(a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor)),a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context)),a.hasOwnProperty("registration")&&(this.registration=a.registration)},_initFromQueryString:function(b){this.log("_initFromQueryString");var c,d,e=TinCan.Utils.parseURL(b).params,f=["endpoint","auth"],g={},h,i,j=null;if(e.hasOwnProperty("actor")){this.log("_initFromQueryString - found actor: "+e.actor);try{this.actor=TinCan.Agent.fromJSON(e.actor),delete e.actor}catch(k){this.log("_initFromQueryString - failed to set actor: "+k)}}e.hasOwnProperty("activity_id")&&(this.activity=new TinCan.Activity({id:e.activity_id}),delete e.activity_id);if(e.hasOwnProperty("activity_platform")||e.hasOwnProperty("registration")||e.hasOwnProperty("grouping"))i={},e.hasOwnProperty("activity_platform")&&(i.platform=e.activity_platform,delete e.activity_platform),e.hasOwnProperty("registration")&&(i.registration=this.registration=e.registration,delete e.registration),e.hasOwnProperty("grouping")&&(i.contextActivities={},i.contextActivities.grouping=e.grouping,delete e.grouping),this.context=new TinCan.Context(i);if(e.hasOwnProperty("endpoint")){for(c=0;c<f.length;c+=1)d=f[c],e.hasOwnProperty(d)&&(g[d]=e[d],delete e[d]);for(c in e)e.hasOwnProperty(c)&&(a.hasOwnProperty(c)?delete e[c]:(j=j||{},j[c]=e[c]));j!==null&&(g.extended=j),g.allowFail=!1,this.addRecordStore(g)}},addRecordStore:function(a){this.log("addRecordStore");var b;a instanceof TinCan.LRS?b=a:b=new TinCan.LRS(a),this.recordStores.push(b)},prepareStatement:function(a){return this.log("prepareStatement"),a instanceof TinCan.Statement||(a=new TinCan.Statement(a)),a.actor===null&&this.actor!==null&&(a.actor=this.actor),a.target===null&&this.activity!==null&&(a.target=this.activity),this.context!==null&&(a.context===null?a.context=this.context:(a.context.registration===null&&(a.context.registration=this.context.registration),a.context.platform===null&&(a.context.platform=this.context.platform),this.context.contextActivities!==null&&(a.context.contextActivities===null?a.context.contextActivities=this.context.contextActivities:(this.context.contextActivities.grouping!==null&&a.context.contextActivities.grouping===null&&(a.context.contextActivities.grouping=this.context.contextActivities.grouping),this.context.contextActivities.parent!==null&&a.context.contextActivities.parent===null&&(a.context.contextActivities.parent=this.context.contextActivities.parent),this.context.contextActivities.other!==null&&a.context.contextActivities.other===null&&(a.context.contextActivities.other=this.context.contextActivities.other))))),a},sendStatement:function(a,b){this.log("sendStatement");var c=this,d,e=this.prepareStatement(a),f=this.recordStores.length,g,h=[],i,j=[];if(f>0){typeof b=="function"&&(i=function(a,d){var g;c.log("sendStatement - callbackWrapper: "+f),f>1?(f-=1,j.push({err:a,xhr:d})):f===1?(j.push({err:a,xhr:d}),g=[j,e],b.apply(this,g)):c.log("sendStatement - unexpected record store count: "+f)});for(g=0;g<f;g+=1)d=this.recordStores[g],h.push(d.saveStatement(e,{callback:i}))}else this.log("[warning] sendStatement: No LRSs added yet (statement not sent)"),typeof b=="function"&&b.apply(this,[null,e]);return{statement:e,results:h}},getStatement:function(a,b){this.log("getStatement");var c;if(this.recordStores.length>0)return c=this.recordStores[0],c.retrieveStatement(a,{callback:b});this.log("[warning] getStatement: No LRSs added yet (statement not retrieved)")},voidStatement:function(a,b,c){this.log("voidStatement");var d=this,e,f,g,h=this.recordStores.length,i,j=[],k,l=[];a instanceof TinCan.Statement&&(a=a.id),typeof c.actor!="undefined"?f=c.actor:this.actor!==null&&(f=this.actor),g=new TinCan.Statement({actor:f,verb:{id:"http://adlnet.gov/expapi/verbs/voided"},target:{objectType:"StatementRef",id:a}});if(h>0){typeof b=="function"&&(k=function(a,c){var e;d.log("voidStatement - callbackWrapper: "+h),h>1?(h-=1,l.push({err:a,xhr:c})):h===1?(l.push({err:a,xhr:c}),e=[l,g],b.apply(this,e)):d.log("voidStatement - unexpected record store count: "+h)});for(i=0;i<h;i+=1)e=this.recordStores[i],j.push(e.saveStatement(g,{callback:k}))}else this.log("[warning] voidStatement: No LRSs added yet (statement not sent)"),typeof b=="function"&&b.apply(this,[null,g]);return{statement:g,results:j}},getVoidedStatement:function(a,b){this.log("getVoidedStatement");var c;if(this.recordStores.length>0)return c=this.recordStores[0],c.retrieveVoidedStatement(a,{callback:b});this.log("[warning] getVoidedStatement: No LRSs added yet (statement not retrieved)")},sendStatements:function(a,b){this.log("sendStatements");var c=this,d,e=[],f=this.recordStores.length,g,h=[],i,j=[];if(a.length===0)typeof b=="function"&&b.apply(this,[null,e]);else{for(g=0;g<a.length;g+=1)e.push(this.prepareStatement(a[g]));if(f>0){typeof b=="function"&&(i=function(a,d){var g;c.log("sendStatements - callbackWrapper: "+f),f>1?(f-=1,j.push({err:a,xhr:d})):f===1?(j.push({err:a,xhr:d}),g=[j,e],b.apply(this,g)):c.log("sendStatements - unexpected record store count: "+f)});for(g=0;g<f;g+=1)d=this.recordStores[g],h.push(d.saveStatements(e,{callback:i}))}else this.log("[warning] sendStatements: No LRSs added yet (statements not sent)"),typeof b=="function"&&b.apply(this,[null,e])}return{statements:e,results:h}},getStatements:function(a){this.log("getStatements");var b={},c,d;if(this.recordStores.length>0)return c=this.recordStores[0],a=a||{},d=a.params||{},a.sendActor&&this.actor!==null&&(c.version==="0.9"||c.version==="0.95"?d.actor=this.actor:d.agent=this.actor),a.sendActivity&&this.activity!==null&&(c.version==="0.9"||c.version==="0.95"?d.target=this.activity:d.activity=this.activity),typeof d.registration=="undefined"&&this.registration!==null&&(d.registration=this.registration),b={params:d},typeof a.callback!="undefined"&&(b.callback=a.callback),c.queryStatements(b);this.log("[warning] getStatements: No LRSs added yet (statements not read)")},getState:function(a,b){this.log("getState");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={agent:typeof b.agent!="undefined"?b.agent:this.actor,activity:typeof b.activity!="undefined"?b.activity:this.activity},typeof b.registration!="undefined"?c.registration=b.registration:this.registration!==null&&(c.registration=this.registration),typeof b.callback!="undefined"&&(c.callback=b.callback),d.retrieveState(a,c);this.log("[warning] getState: No LRSs added yet (state not retrieved)")},setState:function(a,b,c){this.log("setState");var d,e;if(this.recordStores.length>0)return e=this.recordStores[0],c=c||{},d={agent:typeof c.agent!="undefined"?c.agent:this.actor,activity:typeof c.activity!="undefined"?c.activity:this.activity},typeof c.registration!="undefined"?d.registration=c.registration:this.registration!==null&&(d.registration=this.registration),typeof c.lastSHA1!="undefined"&&(d.lastSHA1=c.lastSHA1),typeof c.contentType!="undefined"&&(d.contentType=c.contentType),typeof c.callback!="undefined"&&(d.callback=c.callback),e.saveState(a,b,d);this.log("[warning] setState: No LRSs added yet (state not saved)")},deleteState:function(a,b){this.log("deleteState");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={agent:typeof b.agent!="undefined"?b.agent:this.actor,activity:typeof b.activity!="undefined"?b.activity:this.activity},typeof b.registration!="undefined"?c.registration=b.registration:this.registration!==null&&(c.registration=this.registration),typeof b.callback!="undefined"&&(c.callback=b.callback),d.dropState(a,c);this.log("[warning] deleteState: No LRSs added yet (state not deleted)")},getActivityProfile:function(a,b){this.log("getActivityProfile");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={activity:typeof b.activity!="undefined"?b.activity:this.activity},typeof b.callback!="undefined"&&(c.callback=b.callback),d.retrieveActivityProfile(a,c);this.log("[warning] getActivityProfile: No LRSs added yet (activity profile not retrieved)")},setActivityProfile:function(a,b,c){this.log("setActivityProfile");var d,e;if(this.recordStores.length>0)return e=this.recordStores[0],c=c||{},d={activity:typeof c.activity!="undefined"?c.activity:this.activity},typeof c.callback!="undefined"&&(d.callback=c.callback),typeof c.lastSHA1!="undefined"&&(d.lastSHA1=c.lastSHA1),typeof c.contentType!="undefined"&&(d.contentType=c.contentType),e.saveActivityProfile(a,b,d);this.log("[warning] setActivityProfile: No LRSs added yet (activity profile not saved)")},deleteActivityProfile:function(a,b){this.log("deleteActivityProfile");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={activity:typeof b.activity!="undefined"?b.activity:this.activity},typeof b.callback!="undefined"&&(c.callback=b.callback),d.dropActivityProfile(a,c);this.log("[warning] deleteActivityProfile: No LRSs added yet (activity profile not deleted)")},getAgentProfile:function(a,b){this.log("getAgentProfile");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={agent:typeof b.agent!="undefined"?b.agent:this.actor},typeof b.callback!="undefined"&&(c.callback=b.callback),d.retrieveAgentProfile(a,c);this.log("[warning] getAgentProfile: No LRSs added yet (agent profile not retrieved)")},setAgentProfile:function(a,b,c){this.log("setAgentProfile");var d,e;if(this.recordStores.length>0)return e=this.recordStores[0],c=c||{},d={agent:typeof c.agent!="undefined"?c.agent:this.actor},typeof c.callback!="undefined"&&(d.callback=c.callback),typeof c.lastSHA1!="undefined"&&(d.lastSHA1=c.lastSHA1),typeof c.contentType!="undefined"&&(d.contentType=c.contentType),e.saveAgentProfile(a,b,d);this.log("[warning] setAgentProfile: No LRSs added yet (agent profile not saved)")},deleteAgentProfile:function(a,b){this.log("deleteAgentProfile");var c,d;if(this.recordStores.length>0)return d=this.recordStores[0],b=b||{},c={agent:typeof b.agent!="undefined"?b.agent:this.actor},typeof b.callback!="undefined"&&(c.callback=b.callback),d.dropAgentProfile(a,c);this.log("[warning] deleteAgentProfile: No LRSs added yet (agent profile not deleted)")}},TinCan.DEBUG=!1,TinCan.enableDebug=function(){TinCan.DEBUG=!0},TinCan.disableDebug=function(){TinCan.DEBUG=!1},TinCan.versions=function(){return["1.0.1","1.0.0","0.95","0.9"]},typeof module=="object"&&(module.exports=TinCan)})(),function(){"use strict",TinCan.Utils={getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})},getISODateString:function(a){function b(a,b){var c,d;if(typeof a=="undefined"||a===null)a=0;if(typeof b=="undefined"||b===null)b=2;c=Math.pow(10,b-1),d=a.toString();while(a<c&&c>1)d="0"+d,c/=10;return d}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+b(a.getUTCMilliseconds(),3)+"Z"},getSHA1String:function(a){return CryptoJS.SHA1(a).toString(CryptoJS.enc.Hex)},getBase64String:function(a){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(a))},getLangDictionaryValue:function(a,b){var c=this[a],d;if(typeof b!="undefined"&&typeof c[b]!="undefined")return c[b];if(typeof c.und!="undefined")return c.und;if(typeof c["en-US"]!="undefined")return c["en-US"];for(d in c)if(c.hasOwnProperty(d))return c[d];return""},parseURL:function(a){var b=String(a).split("?"),c,d,e,f={};if(b.length===2){c=b[1].split("&");for(e=0;e<c.length;e+=1)d=c[e].split("="),d.length===2&&d[0]&&(f[d[0]]=decodeURIComponent(d[1]))}return{path:b[0],params:f}},getServerRoot:function(a){var b=a.split("/");return b[0]+"//"+b[2]},getContentTypeFromHeader:function(a){return String(a).split(";")[0]},isApplicationJSON:function(a){return TinCan.Utils.getContentTypeFromHeader(a).toLowerCase().indexOf("application/json")===0}}}(),function(){"use strict";var a=TinCan.LRS=function(a){this.log("constructor"),this.endpoint=null,this.version=null,this.auth=null,this.allowFail=!0,this.extended=null,this.init(a)};a.prototype={LOG_SRC:"LRS",log:TinCan.prototype.log,init:function(a){this.log("init");var b=TinCan.versions(),c=!1,d;a=a||{},a.hasOwnProperty("alertOnRequestFailure")&&this.log("'alertOnRequestFailure' is deprecated (alerts have been removed) no need to set it now");if(!a.hasOwnProperty("endpoint")||a.endpoint===null||a.endpoint==="")throw this.log("[error] LRS invalid: no endpoint"),{code:3,mesg:"LRS invalid: no endpoint"};this.endpoint=String(a.endpoint),this.endpoint.slice(-1)!=="/"&&(this.log("adding trailing slash to endpoint"),this.endpoint+="/"),a.hasOwnProperty("allowFail")&&(this.allowFail=a.allowFail),a.hasOwnProperty("auth")?this.auth=a.auth:a.hasOwnProperty("username")&&a.hasOwnProperty("password")&&(this.auth="Basic "+TinCan.Utils.getBase64String(a.username+":"+a.password)),a.hasOwnProperty("extended")&&(this.extended=a.extended),this._initByEnvironment(a);if(typeof a.version!="undefined"){this.log("version: "+a.version);for(d=0;d<b.length;d+=1)if(b[d]===a.version){c=!0;break}if(!c)throw this.log("[error] LRS invalid: version not supported ("+a.version+")"),{code:5,mesg:"LRS invalid: version not supported ("+a.version+")"};this.version=a.version}else this.version=b[0]},_initByEnvironment:function(){this.log("_initByEnvironment not overloaded - no environment loaded?")},_makeRequest:function(){this.log("_makeRequest not overloaded - no environment loaded?")},sendRequest:function(a){this.log("sendRequest");var b=this.endpoint+a.url,c={},d;a.url.indexOf("http")===0&&(b=a.url);if(this.extended!==null){a.params=a.params||{};for(d in this.extended)this.extended.hasOwnProperty(d)&&(a.params.hasOwnProperty(d)||this.extended[d]!==null&&(a.params[d]=this.extended[d]))}c.Authorization=this.auth,this.version!=="0.9"&&(c["X-Experience-API-Version"]=this.version);for(d in a.headers)a.headers.hasOwnProperty(d)&&(c[d]=a.headers[d]);return this._makeRequest(b,c,a)},saveStatement:function(a,b){this.log("saveStatement");var c,d;b=b||{};try{d=a.asVersion(this.version)}catch(e){if(this.allowFail){this.log("[warning] statement could not be serialized in version ("+this.version+"): "+e);if(typeof b.callback!="undefined"){b.callback(null,null);return}return{err:null,xhr:null}}this.log("[error] statement could not be serialized in version ("+this.version+"): "+e);if(typeof b.callback!="undefined"){b.callback(e,null);return}return{err:e,xhr:null}}return c={url:"statements",data:JSON.stringify(d),headers:{"Content-Type":"application/json"}},a.id!==null?(c.method="PUT",c.params={statementId:a.id}):c.method="POST",typeof b.callback!="undefined"&&(c.callback=b.callback),this.sendRequest(c)},retrieveStatement:function(a,b){this.log("retrieveStatement");var c,d,e;return b=b||{},c={url:"statements",method:"GET",params:{statementId:a}},typeof b.callback!="undefined"&&(e=function(a,c){var d=c;a===null&&(d=TinCan.Statement.fromJSON(c.responseText)),b.callback(a,d)},c.callback=e),d=this.sendRequest(c),e||(d.statement=null,d.err===null&&(d.statement=TinCan.Statement.fromJSON(d.xhr.responseText))),d},retrieveVoidedStatement:function(a,b){this.log("retrieveVoidedStatement");var c,d,e;return b=b||{},c={url:"statements",method:"GET",params:{}},this.version==="0.9"||this.version==="0.95"?c.params.statementId=a:c.params.voidedStatementId=a,typeof b.callback!="undefined"&&(e=function(a,c){var d=c;a===null&&(d=TinCan.Statement.fromJSON(c.responseText)),b.callback(a,d)},c.callback=e),d=this.sendRequest(c),e||(d.statement=null,d.err===null&&(d.statement=TinCan.Statement.fromJSON(d.xhr.responseText))),d},saveStatements:function(a,b){this.log("saveStatements");var c,d,e=[],f;b=b||{};if(a.length===0){if(typeof b.callback!="undefined"){b.callback(new Error("no statements"),null);return}return{err:new Error("no statements"),xhr:null}}for(f=0;f<a.length;f+=1){try{d=a[f].asVersion(this.version)}catch(g){if(this.allowFail){this.log("[warning] statement could not be serialized in version ("+this.version+"): "+g);if(typeof b.callback!="undefined"){b.callback(null,null);return}return{err:null,xhr:null}}this.log("[error] statement could not be serialized in version ("+this.version+"): "+g);if(typeof b.callback!="undefined"){b.callback(g,null);return}return{err:g,xhr:null}}e.push(d)}return c={url:"statements",method:"POST",data:JSON.stringify(e),headers:{"Content-Type":"application/json"}},typeof b.callback!="undefined"&&(c.callback=b.callback),this.sendRequest(c)},queryStatements:function(a){this.log("queryStatements");var b,c,d;a=a||{},a.params=a.params||{};try{b=this._queryStatementsRequestCfg(a)}catch(e){return this.log("[error] Query statements failed - "+e),typeof a.callback!="undefined"&&a.callback(e,{}),{err:e,statementsResult:null}}return typeof a.callback!="undefined"&&(d=function(b,c){var d=c;b===null&&(d=TinCan.StatementsResult.fromJSON(c.responseText)),a.callback(b,d)},b.callback=d),c=this.sendRequest(b),c.config=b,d||(c.statementsResult=null,c.err===null&&(c.statementsResult=TinCan.StatementsResult.fromJSON(c.xhr.responseText))),c},_queryStatementsRequestCfg:function(a){this.log("_queryStatementsRequestCfg");var b={},c={url:"statements",method:"GET",params:b},d=["agent","actor","object","instructor"],e=["verb","activity"],f=["registration","context","since","until","limit","authoritative","sparse","ascending","related_activities","related_agents","format","attachments"],g,h,i={verb:!0,registration:!0,since:!0,until:!0,limit:!0,ascending:!0},j={.9:{supported:{actor:!0,instructor:!0,target:!0,object:!0,context:!0,authoritative:!0,sparse:!0}},"1.0.0":{supported:{agent:!0,activity:!0,related_activities:!0,related_agents:!0,format:!0,attachments:!0}}};j["0.95"]=j["0.9"],a.params.hasOwnProperty("target")&&(a.params.object=a.params.target);for(h in a.params)if(a.params.hasOwnProperty(h)&&typeof i[h]=="undefined"&&typeof j[this.version].supported[h]=="undefined")throw"Unrecognized query parameter configured: "+h;for(g=0;g<d.length;g+=1)typeof a.params[d[g]]!="undefined"&&(b[d[g]]=JSON.stringify(a.params[d[g]].asVersion(this.version)));for(g=0;g<e.length;g+=1)typeof a.params[e[g]]!="undefined"&&(b[e[g]]=a.params[e[g]].id);for(g=0;g<f.length;g+=1)typeof a.params[f[g]]!="undefined"&&(b[f[g]]=a.params[f[g]]);return c},moreStatements:function(a){this.log("moreStatements: "+a.url);var b,c,d,e,f;return a=a||{},e=TinCan.Utils.parseURL(a.url),f=TinCan.Utils.getServerRoot(this.endpoint),e.path.indexOf("/statements")===0&&(e.path=this.endpoint.replace(f,"")+e.path,this.log("converting non-standard more URL to "+e.path)),e.path.indexOf("/")!==0&&(e.path="/"+e.path),b={method:"GET",url:f+e.path,params:e.params},typeof a.callback!="undefined"&&(d=function(b,c){var d=c;b===null&&(d=TinCan.StatementsResult.fromJSON(c.responseText)),a.callback(b,d)},b.callback=d),c=this.sendRequest(b),c.config=b,d||(c.statementsResult=null,c.err===null&&(c.statementsResult=TinCan.StatementsResult.fromJSON(c.xhr.responseText))),c},retrieveState:function(a,b){this.log("retrieveState");var c={},d={},e,f;c={stateId:a,activityId:b.activity.id},this.version==="0.9"?c.actor=JSON.stringify(b.agent.asVersion(this.version)):c.agent=JSON.stringify(b.agent.asVersion(this.version)),typeof b.registration!="undefined"&&(this.version==="0.9"?c.registrationId=b.registration:c.registration=b.registration),d={url:"activities/state",method:"GET",params:c,ignore404:!0},typeof b.callback!="undefined"&&(f=function(c,d){var e=d;if(c===null)if(d.status===404)e=null;else{e=new TinCan.State({id:a,contents:d.responseText}),typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("ETag")!==null&&d.getResponseHeader("ETag")!==""?e.etag=d.getResponseHeader("ETag"):e.etag=TinCan.Utils.getSHA1String(d.responseText),typeof d.contentType!="undefined"?e.contentType=d.contentType:typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("Content-Type")!==null&&d.getResponseHeader("Content-Type")!==""&&(e.contentType=d.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(f){this.log("retrieveState - failed to deserialize JSON: "+f)}}b.callback(c,e)},d.callback=f),e=this.sendRequest(d);if(!f){e.state=null;if(e.err===null&&e.xhr.status!==404){e.state=new TinCan.State({id:a,contents:e.xhr.responseText}),typeof e.xhr.getResponseHeader!="undefined"&&e.xhr.getResponseHeader("ETag")!==null&&e.xhr.getResponseHeader("ETag")!==""?e.state.etag=e.xhr.getResponseHeader("ETag"):e.state.etag=TinCan.Utils.getSHA1String(e.xhr.responseText),typeof e.xhr.contentType!="undefined"?e.state.contentType=e.xhr.contentType:typeof e.xhr.getResponseHeader!="undefined"&&e.xhr.getResponseHeader("Content-Type")!==null&&e.xhr.getResponseHeader("Content-Type")!==""&&(e.state.contentType=e.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(e.state.contentType))try{e.state.contents=JSON.parse(e.state.contents)}catch(g){this.log("retrieveState - failed to deserialize JSON: "+g)}}}return e},saveState:function(a,b,c){this.log("saveState");var d,e,f;return typeof c.contentType=="undefined"&&(c.contentType="application/octet-stream"),typeof b=="object"&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),d={stateId:a,activityId:c.activity.id},this.version==="0.9"?d.actor=JSON.stringify(c.agent.asVersion(this.version)):d.agent=JSON.stringify(c.agent.asVersion(this.version)),typeof c.registration!="undefined"&&(this.version==="0.9"?d.registrationId=c.registration:d.registration=c.registration),e={url:"activities/state",method:"PUT",params:d,data:b,headers:{"Content-Type":c.contentType}},typeof c.callback!="undefined"&&(e.callback=c.callback),typeof c.lastSHA1!="undefined"&&c.lastSHA1!==null&&(e.headers["If-Match"]=c.lastSHA1),this.sendRequest(e)},dropState:function(a,b){this.log("dropState");var c,d;return c={activityId:b.activity.id},this.version==="0.9"?c.actor=JSON.stringify(b.agent.asVersion(this.version)):c.agent=JSON.stringify(b.agent.asVersion(this.version)),a!==null&&(c.stateId=a),typeof b.registration!="undefined"&&(this.version==="0.9"?c.registrationId=b.registration:c.registration=b.registration),d={url:"activities/state",method:"DELETE",params:c},typeof b.callback!="undefined"&&(d.callback=b.callback),this.sendRequest(d)},retrieveActivityProfile:function(a,b){this.log("retrieveActivityProfile");var c={},d,e;c={url:"activities/profile",method:"GET",params:{profileId:a,activityId:b.activity.id},ignore404:!0},typeof b.callback!="undefined"&&(e=function(c,d){var e=d;if(c===null)if(d.status===404)e=null;else{e=new TinCan.ActivityProfile({id:a,activity:b.activity,contents:d.responseText}),typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("ETag")!==null&&d.getResponseHeader("ETag")!==""?e.etag=d.getResponseHeader("ETag"):e.etag=TinCan.Utils.getSHA1String(d.responseText),typeof d.contentType!="undefined"?e.contentType=d.contentType:typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("Content-Type")!==null&&d.getResponseHeader("Content-Type")!==""&&(e.contentType=d.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(f){this.log("retrieveActivityProfile - failed to deserialize JSON: "+f)}}b.callback(c,e)},c.callback=e),d=this.sendRequest(c);if(!e){d.profile=null;if(d.err===null&&d.xhr.status!==404){d.profile=new TinCan.ActivityProfile({id:a,activity:b.activity,contents:d.xhr.responseText}),typeof d.xhr.getResponseHeader!="undefined"&&d.xhr.getResponseHeader("ETag")!==null&&d.xhr.getResponseHeader("ETag")!==""?d.profile.etag=d.xhr.getResponseHeader("ETag"):d.profile.etag=TinCan.Utils.getSHA1String(d.xhr.responseText),typeof d.xhr.contentType!="undefined"?d.profile.contentType=d.xhr.contentType:typeof d.xhr.getResponseHeader!="undefined"&&d.xhr.getResponseHeader("Content-Type")!==null&&d.xhr.getResponseHeader("Content-Type")!==""&&(d.profile.contentType=d.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(d.profile.contentType))try{d.profile.contents=JSON.parse(d.profile.contents)}catch(f){this.log("retrieveActivityProfile - failed to deserialize JSON: "+f)}}}return d},saveActivityProfile:function(a,b,c){this.log("saveActivityProfile");var d;return typeof c.contentType=="undefined"&&(c.contentType="application/octet-stream"),typeof b=="object"&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),d={url:"activities/profile",method:"PUT",params:{profileId:a,activityId:c.activity.id},data:b,headers:{"Content-Type":c.contentType}},typeof c.callback!="undefined"&&(d.callback=c.callback),typeof c.lastSHA1!="undefined"&&c.lastSHA1!==null?d.headers["If-Match"]=c.lastSHA1:d.headers["If-None-Match"]="*",this.sendRequest(d)},dropActivityProfile:function(a,b){this.log("dropActivityProfile");var c,d;return c={profileId:a,activityId:b.activity.id},d={url:"activities/profile",method:"DELETE",params:c},typeof b.callback!="undefined"&&(d.callback=b.callback),this.sendRequest(d)},retrieveAgentProfile:function(a,b){this.log("retrieveAgentProfile");var c={},d,e;c={method:"GET",params:{profileId:a},ignore404:!0},this.version==="0.9"?(c.url="actors/profile",c.params.actor=JSON.stringify(b.agent.asVersion(this.version))):(c.url="agents/profile",c.params.agent=JSON.stringify(b.agent.asVersion(this.version))),typeof b.callback!="undefined"&&(e=function(c,d){var e=d;if(c===null)if(d.status===404)e=null;else{e=new TinCan.AgentProfile({id:a,agent:b.agent,contents:d.responseText}),typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("ETag")!==null&&d.getResponseHeader("ETag")!==""?e.etag=d.getResponseHeader("ETag"):e.etag=TinCan.Utils.getSHA1String(d.responseText),typeof d.contentType!="undefined"?e.contentType=d.contentType:typeof d.getResponseHeader!="undefined"&&d.getResponseHeader("Content-Type")!==null&&d.getResponseHeader("Content-Type")!==""&&(e.contentType=d.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(f){this.log("retrieveAgentProfile - failed to deserialize JSON: "+f)}}b.callback(c,e)},c.callback=e),d=this.sendRequest(c);if(!e){d.profile=null;if(d.err===null&&d.xhr.status!==404){d.profile=new TinCan.AgentProfile({id:a,agent:b.agent,contents:d.xhr.responseText}),typeof d.xhr.getResponseHeader!="undefined"&&d.xhr.getResponseHeader("ETag")!==null&&d.xhr.getResponseHeader("ETag")!==""?d.profile.etag=d.xhr.getResponseHeader("ETag"):d.profile.etag=TinCan.Utils.getSHA1String(d.xhr.responseText),typeof d.xhr.contentType!="undefined"?d.profile.contentType=d.xhr.contentType:typeof d.xhr.getResponseHeader!="undefined"&&d.xhr.getResponseHeader("Content-Type")!==null&&d.xhr.getResponseHeader("Content-Type")!==""&&(d.profile.contentType=d.xhr.getResponseHeader("Content-Type"));if(TinCan.Utils.isApplicationJSON(d.profile.contentType))try{d.profile.contents=JSON.parse(d.profile.contents)}catch(f){this.log("retrieveAgentProfile - failed to deserialize JSON: "+f)}}}return d},saveAgentProfile:function(a,b,c){this.log("saveAgentProfile");var d;return typeof c.contentType=="undefined"&&(c.contentType="application/octet-stream"),typeof b=="object"&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),d={method:"PUT",params:{profileId:a},data:b,headers:{"Content-Type":c.contentType}},this.version==="0.9"?(d.url="actors/profile",d.params.actor=JSON.stringify(c.agent.asVersion(this.version))):(d.url="agents/profile",d.params.agent=JSON.stringify(c.agent.asVersion(this.version))),typeof c.callback!="undefined"&&(d.callback=c.callback),typeof c.lastSHA1!="undefined"&&c.lastSHA1!==null?d.headers["If-Match"]=c.lastSHA1:d.headers["If-None-Match"]="*",this.sendRequest(d)},dropAgentProfile:function(a,b){this.log("dropAgentProfile");var c,d;return c={profileId:a},d={method:"DELETE",params:c},this.version==="0.9"?(d.url="actors/profile",c.actor=JSON.stringify(b.agent.asVersion(this.version))):(d.url="agents/profile",c.agent=JSON.stringify(b.agent.asVersion(this.version))),typeof b.callback!="undefined"&&(d.callback=b.callback),this.sendRequest(d)}}}(),function(){"use strict";var a=TinCan.AgentAccount=function(a){this.log("constructor"),this.homePage=null,this.name=null,this.init(a)};a.prototype={LOG_SRC:"AgentAccount",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["name","homePage"],d;a=a||{},typeof a.accountServiceHomePage!="undefined"&&(a.homePage=a.accountServiceHomePage),typeof a.accountName!="undefined"&&(a.name=a.accountName);for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},toString:function(a){this.log("toString");var b="";return this.name!==null||this.homePage!==null?(b+=this.name!==null?this.name:"-",b+=":",b+=this.homePage!==null?this.homePage:"-"):b="AgentAccount: unidentified",b},asVersion:function(a){this.log("asVersion: "+a);var b={};return a=a||TinCan.versions()[0],a==="0.9"?(b.accountName=this.name,b.accountServiceHomePage=this.homePage):(b.name=this.name,b.homePage=this.homePage),b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.Agent=function(a){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.degraded=!1,this.init(a)};a.prototype={objectType:"Agent",LOG_SRC:"Agent",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["name","mbox","mbox_sha1sum","openid"],d;a=a||{};if(typeof a.lastName!="undefined"||typeof a.firstName!="undefined")a.name="",typeof a.firstName!="undefined"&&a.firstName.length>0&&(a.name=a.firstName[0],a.firstName.length>1&&(this.degraded=!0)),a.name!==""&&(a.name+=" "),typeof a.lastName!="undefined"&&a.lastName.length>0&&(a.name+=a.lastName[0],a.lastName.length>1&&(this.degraded=!0));else if(typeof a.familyName!="undefined"||typeof a.givenName!="undefined")a.name="",typeof a.givenName!="undefined"&&a.givenName.length>0&&(a.name=a.givenName[0],a.givenName.length>1&&(this.degraded=!0)),a.name!==""&&(a.name+=" "),typeof a.familyName!="undefined"&&a.familyName.length>0&&(a.name+=a.familyName[0],a.familyName.length>1&&(this.degraded=!0));typeof a.name=="object"&&a.name!==null&&(a.name.length>1&&(this.degraded=!0),a.name=a.name[0]),typeof a.mbox=="object"&&a.mbox!==null&&(a.mbox.length>1&&(this.degraded=!0),a.mbox=a.mbox[0]),typeof a.mbox_sha1sum=="object"&&a.mbox_sha1sum!==null&&(a.mbox_sha1sum.length>1&&(this.degraded=!0),a.mbox_sha1sum=a.mbox_sha1sum[0]),typeof a.openid=="object"&&a.openid!==null&&(a.openid.length>1&&(this.degraded=!0),a.openid=a.openid[0]),typeof a.account=="object"&&a.account!==null&&typeof a.account.homePage=="undefined"&&typeof a.account.name=="undefined"&&(a.account.length===0?delete a.account:(a.account.length>1&&(this.degraded=!0),a.account=a.account[0])),a.hasOwnProperty("account")&&(a.account instanceof TinCan.AgentAccount?this.account=a.account:this.account=new TinCan.AgentAccount(a.account));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(d=a[c[b]],c[b]==="mbox"&&d.indexOf("mailto:")===-1&&(d="mailto:"+d),this[c[b]]=d)},toString:function(a){return this.log("toString"),this.name!==null?this.name:this.mbox!==null?this.mbox.replace("mailto:",""):this.mbox_sha1sum!==null?this.mbox_sha1sum:this.openid!==null?this.openid:this.account!==null?this.account.toString():this.objectType+": unidentified"},asVersion:function(a){this.log("asVersion: "+a);var b={objectType:this.objectType};return a=a||TinCan.versions()[0],a==="0.9"?(this.mbox!==null?b.mbox=[this.mbox]:this.mbox_sha1sum!==null?b.mbox_sha1sum=[this.mbox_sha1sum]:this.openid!==null?b.openid=[this.openid]:this.account!==null&&(b.account=[this.account.asVersion(a)]),this.name!==null&&(b.name=[this.name])):(this.mbox!==null?b.mbox=this.mbox:this.mbox_sha1sum!==null?b.mbox_sha1sum=this.mbox_sha1sum:this.openid!==null?b.openid=this.openid:this.account!==null&&(b.account=this.account.asVersion(a)),this.name!==null&&(b.name=this.name)),b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.Group=function(a){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.member=[],this.init(a)};a.prototype={objectType:"Group",LOG_SRC:"Group",log:TinCan.prototype.log,init:function(a){this.log("init");var b;a=a||{},TinCan.Agent.prototype.init.call(this,a);if(typeof a.member!="undefined")for(b=0;b<a.member.length;b+=1)a.member[b]instanceof TinCan.Agent?this.member.push(a.member[b]):this.member.push(new TinCan.Agent(a.member[b]))},toString:function(a){this.log("toString");var b=TinCan.Agent.prototype.toString.call(this,a);return b!==this.objectType+": unidentified"&&(b=this.objectType+": "+b),b},asVersion:function(a){this.log("asVersion: "+a);var b,c;a=a||TinCan.versions()[0],b=TinCan.Agent.prototype.asVersion.call(this,a);if(this.member.length>0){b.member=[];for(c=0;c<this.member.length;c+=1)b.member.push(this.member[c].asVersion(a))}return b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a={"http://adlnet.gov/expapi/verbs/experienced":"experienced","http://adlnet.gov/expapi/verbs/attended":"attended","http://adlnet.gov/expapi/verbs/attempted":"attempted","http://adlnet.gov/expapi/verbs/completed":"completed","http://adlnet.gov/expapi/verbs/passed":"passed","http://adlnet.gov/expapi/verbs/failed":"failed","http://adlnet.gov/expapi/verbs/answered":"answered","http://adlnet.gov/expapi/verbs/interacted":"interacted","http://adlnet.gov/expapi/verbs/imported":"imported","http://adlnet.gov/expapi/verbs/created":"created","http://adlnet.gov/expapi/verbs/shared":"shared","http://adlnet.gov/expapi/verbs/voided":"voided"},b=TinCan.Verb=function(a){this.log("constructor"),this.id=null,this.display=null,this.init(a)};b.prototype={LOG_SRC:"Verb",log:TinCan.prototype.log,init:function(b){this.log("init");var c,d=["id","display"],e;if(typeof b=="string"){this.id=b,this.display={und:this.id};for(e in a)if(a.hasOwnProperty(e)&&a[e]===b){this.id=e;break}}else{b=b||{};for(c=0;c<d.length;c+=1)b.hasOwnProperty(d[c])&&b[d[c]]!==null&&(this[d[c]]=b[d[c]]);this.display===null&&typeof a[this.id]!="undefined"&&(this.display={und:a[this.id]})}},toString:function(a){return this.log("toString"),this.display!==null?this.getLangDictionaryValue("display",a):this.id},asVersion:function(b){this.log("asVersion");var c;return b=b||TinCan.versions()[0],b==="0.9"?c=a[this.id]:(c={id:this.id},this.display!==null&&(c.display=this.display)),c},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},b.fromJSON=function(a){b.prototype.log("fromJSON");var c=JSON.parse(a);return new b(c)}}(),function(){"use strict";var a=TinCan.Result=function(a){this.log("constructor"),this.score=null,this.success=null,this.completion=null,this.duration=null,this.response=null,this.extensions=null,this.init(a)};a.prototype={LOG_SRC:"Result",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["completion","duration","extensions","response","success"];a=a||{},a.hasOwnProperty("score")&&a.score!==null&&(a.score instanceof TinCan.Score?this.score=a.score:this.score=new TinCan.Score(a.score));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]]);this.completion==="Completed"&&(this.completion=!0)},asVersion:function(a){this.log("asVersion");var b={},c=["success","duration","response","extensions"],d=["score"],e,f;a=a||TinCan.versions()[0];for(e=0;e<c.length;e+=1)this[c[e]]!==null&&(b[c[e]]=this[c[e]]);for(e=0;e<d.length;e+=1)this[d[e]]!==null&&(b[d[e]]=this[d[e]].asVersion(a));return this.completion!==null&&(a==="0.9"?this.completion&&(b.completion="Completed"):b.completion=this.completion),b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.Score=function(a){this.log("constructor"),this.scaled=null,this.raw=null,this.min=null,this.max=null,this.init(a)};a.prototype={LOG_SRC:"Score",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["scaled","raw","min","max"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},asVersion:function(a){this.log("asVersion");var b={},c=["scaled","raw","min","max"],d,e;a=a||TinCan.versions()[0];for(d=0;d<c.length;d+=1)this[c[d]]!==null&&(b[c[d]]=this[c[d]]);return b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.InteractionComponent=function(a){this.log("constructor"),this.id=null,this.description=null,this.init(a)};a.prototype={LOG_SRC:"InteractionComponent",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","description"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},asVersion:function(a){this.log("asVersion");var b={id:this.id},c=["description"],d,e;a=a||TinCan.versions()[0];for(d=0;d<c.length;d+=1)e=c[d],this[e]!==null&&(b[e]=this[e]);return b},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a={"http://adlnet.gov/expapi/activities/course":"course","http://adlnet.gov/expapi/activities/module":"module","http://adlnet.gov/expapi/activities/meeting":"meeting","http://adlnet.gov/expapi/activities/media":"media","http://adlnet.gov/expapi/activities/performance":"performance","http://adlnet.gov/expapi/activities/simulation":"simulation","http://adlnet.gov/expapi/activities/assessment":"assessment","http://adlnet.gov/expapi/activities/interaction":"interaction","http://adlnet.gov/expapi/activities/cmi.interaction":"cmi.interaction","http://adlnet.gov/expapi/activities/question":"question","http://adlnet.gov/expapi/activities/objective":"objective","http://adlnet.gov/expapi/activities/link":"link"},b=TinCan.ActivityDefinition=function(a){this.log("constructor"),this.name=null,this.description=null,this.type=null,this.moreInfo=null,this.extensions=null,this.interactionType=null,this.correctResponsesPattern=null,this.choices=null,this.scale=null,this.source=null,this.target=null,this.steps=null,this.init(a)};b.prototype={LOG_SRC:"ActivityDefinition",log:TinCan.prototype.log,init:function(b){this.log("init");var c,d,e,f=["name","description","moreInfo","extensions","correctResponsesPattern"],g=[];b=b||{};if(b.hasOwnProperty("type")&&b.type!==null){for(e in a)a.hasOwnProperty(e)&&a[e]===b.type&&(b.type=a[e]);this.type=b.type}if(b.hasOwnProperty("interactionType")&&b.interactionType!==null){this.interactionType=b.interactionType,b.interactionType==="choice"||b.interactionType==="sequencing"?g.push("choices"):b.interactionType==="likert"?g.push("scale"):b.interactionType==="matching"?(g.push("source"),g.push("target")):b.interactionType==="performance"&&g.push("steps");if(g.length>0)for(c=0;c<g.length;c+=1){e=g[c];if(b.hasOwnProperty(e)&&b[e]!==null){this[e]=[];for(d=0;d<b[e].length;d+=1)b[e][d]instanceof TinCan.InteractionComponent?this[e].push(b[e][d]):this[e].push(new TinCan.InteractionComponent(b[e][d]))}}}for(c=0;c<f.length;c+=1)b.hasOwnProperty(f[c])&&b[f[c]]!==null&&(this[f[c]]=b[f[c]])},toString:function(a){return this.log("toString"),this.name!==null?this.getLangDictionaryValue("name",a):this.description!==null?this.getLangDictionaryValue("description",a):""},asVersion:function(b){this.log("asVersion");var c={},d=["name","description","interactionType","correctResponsesPattern","extensions"],e=["choices","scale","source","target","steps"],f,g,h;b=b||TinCan.versions()[0],this.type!==null&&(b==="0.9"?c.type=a[this.type]:c.type=this.type);for(f=0;f<d.length;f+=1)h=d[f],this[h]!==null&&(c[h]=this[h]);for(f=0;f<e.length;f+=1){h=e[f];if(this[h]!==null){c[h]=[];for(g=0;g<this[h].length;g+=1)c[h].push(this[h][g].asVersion(b))}}return b.indexOf("0.9")!==0&&this.moreInfo!==null&&(c.moreInfo=this.moreInfo),c},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},b.fromJSON=function(a){b.prototype.log("fromJSON");var c=JSON.parse(a);return new b(c)}}(),function(){"use strict";var a=TinCan.Activity=function(a){this.log("constructor"),this.objectType="Activity",this.id=null,this.definition=null,this.init(a)};a.prototype={LOG_SRC:"Activity",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id"];a=a||{},a.hasOwnProperty("definition")&&(a.definition instanceof TinCan.ActivityDefinition?this.definition=a.definition:this.definition=new TinCan.ActivityDefinition(a.definition));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},toString:function(a){this.log("toString");var b="";if(this.definition!==null){b=this.definition.toString(a);if(b!=="")return b}return this.id!==null?this.id:"Activity: unidentified"},asVersion:function(a){this.log("asVersion");var b={id:this.id,objectType:this.objectType};return a=a||TinCan.versions()[0],this.definition!==null&&(b.definition=this.definition.asVersion(a)),b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.ContextActivities=function(a){this.log("constructor"),this.category=null,this.parent=null,this.grouping=null,this.other=null,this.init(a)};a.prototype={LOG_SRC:"ContextActivities",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c,d=["category","parent","grouping","other"],e,f;a=a||{};for(b=0;b<d.length;b+=1){e=d[b];if(a.hasOwnProperty(e)&&a[e]!==null)if(Object.prototype.toString.call(a[e])==="[object Array]")for(c=0;c<a[e].length;c+=1)this.add(e,a[e][c]);else f=a[e],this.add(e,f)}},add:function(a,b){if(a!=="category"&&a!=="parent"&&a!=="grouping"&&a!=="other")return;return this[a]===null&&(this[a]=[]),b instanceof TinCan.Activity||(b=typeof b=="string"?{id:b}:b,b=new TinCan.Activity(b)),this[a].push(b),this[a].length-1},asVersion:function(a){this.log("asVersion");var b={},c=["parent","grouping","other"],d,e,f;a=a||TinCan.versions()[0];for(d=0;d<c.length;d+=1)if(this[c[d]]!==null&&this[c[d]].length>0)if(a==="0.9"||a==="0.95")this[c[d]].length>1&&this.log("[warning] version does not support multiple values in: "+c[d]),b[c[d]]=this[c[d]][0].asVersion(a);else{b[c[d]]=[];for(e=0;e<this[c[d]].length;e+=1)b[c[d]].push(this[c[d]][e].asVersion(a))}if(this.category!==null&&this.category.length>0){if(a==="0.9"||a==="0.95")throw this.log("[error] version does not support the 'category' property: "+a),new Error(a+" does not support the 'category' property");b.category=[];for(d=0;d<this.category.length;d+=1)b.category.push(this.category[d].asVersion(a))}return b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.Context=function(a){this.log("constructor"),this.registration=null,this.instructor=null,this.team=null,this.contextActivities=null,this.revision=null,this.platform=null,this.language=null,this.statement=null,this.extensions=null,this.init(a)};a.prototype={LOG_SRC:"Context",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["registration","revision","platform","language","statement","extensions"],d=["instructor","team"],e,f;a=a||{};for(b=0;b<c.length;b+=1)e=c[b],a.hasOwnProperty(e)&&a[e]!==null&&(this[e]=a[e]);for(b=0;b<d.length;b+=1){e=d[b];if(a.hasOwnProperty(e)&&a[e]!==null){f=a[e];if(typeof f.objectType=="undefined"||f.objectType==="Person")f.objectType="Agent";f.objectType!=="Agent"||f instanceof TinCan.Agent?f.objectType==="Group"&&!(f instanceof TinCan.Group)&&(f=new TinCan.Group(f)):f=new TinCan.Agent(f),this[e]=f}}a.hasOwnProperty("contextActivities")&&a.contextActivities!==null&&(a.contextActivities instanceof TinCan.ContextActivities?this.contextActivities=a.contextActivities:this.contextActivities=new TinCan.ContextActivities(a.contextActivities))},asVersion:function(a){this.log("asVersion");var b={},c=["registration","revision","platform","language","extensions"],d=["instructor","team","contextActivities","statement"],e,f;a=a||TinCan.versions()[0];for(e=0;e<c.length;e+=1)this[c[e]]!==null&&(b[c[e]]=this[c[e]]);for(e=0;e<d.length;e+=1)this[d[e]]!==null&&(b[d[e]]=this[d[e]].asVersion(a));return b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.StatementRef=function(a){this.log("constructor"),this.id=null,this.init(a)};a.prototype={objectType:"StatementRef",LOG_SRC:"StatementRef",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id"],d;a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},toString:function(a){return this.log("toString"),this.id},asVersion:function(a){this.log("asVersion");var b={objectType:this.objectType,id:this.id};return a==="0.9"&&(b.objectType="Statement"),b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.SubStatement=function(a){this.log("constructor"),this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.init(a)};a.prototype={objectType:"SubStatement",LOG_SRC:"SubStatement",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["timestamp"],d;a=a||{},a.hasOwnProperty("object")&&(a.target=a.object);if(a.hasOwnProperty("actor")){if(typeof a.actor.objectType=="undefined"||a.actor.objectType==="Person")a.actor.objectType="Agent";a.actor.objectType==="Agent"?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):a.actor.objectType==="Group"&&(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor))}a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb)),a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||a.target instanceof TinCan.StatementRef?this.target=a.target:(typeof a.target.objectType=="undefined"&&(a.target.objectType="Activity"),a.target.objectType==="Activity"?this.target=new TinCan.Activity(a.target):a.target.objectType==="Agent"?this.target=new TinCan.Agent(a.target):a.target.objectType==="Group"?this.target=new TinCan.Group(a.target):a.target.objectType==="SubStatement"?this.target=new TinCan.SubStatement(a.target):a.target.objectType==="StatementRef"?this.target=new TinCan.StatementRef(a.target):this.log("Unrecognized target type: "+a.target.objectType))),a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result)),a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]])},toString:function(a){return this.log("toString"),(this.actor!==null?this.actor.toString(a):"")+" "+(this.verb!==null?this.verb.toString(a):"")+" "+(this.target!==null?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var b,c=["timestamp"],d=["result","context"],e;a=a||TinCan.versions()[0],b={objectType:this.objectType,actor:this.actor.asVersion(a),verb:this.verb.asVersion(a),object:this.target.asVersion(a)};for(e=0;e<c.length;e+=1)this[c[e]]!==null&&(b[c[e]]=this[c[e]]);for(e=0;e<d.length;e+=1)this[d[e]]!==null&&(b[d[e]]=this[d[e]].asVersion(a));return b}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.Statement=function(a,b){this.log("constructor"),typeof b=="number"?b={storeOriginal:b}:b=b||{},typeof b.storeOriginal=="undefined"&&(b.storeOriginal=null),typeof b.doStamp=="undefined"&&(b.doStamp=!0),this.id=null,this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.stored=null,this.authority=null,this.version=null,this.degraded=!1,this.voided=null,this.inProgress=null,this.originalJSON=null,this.init(a,b)};a.prototype={LOG_SRC:"Statement",log:TinCan.prototype.log,init:function(a,b){this.log("init");var c,d=["id","stored","timestamp","version","inProgress","voided"],e;a=a||{},b.storeOriginal&&(this.originalJSON=JSON.stringify(a,null,b.storeOriginal)),a.hasOwnProperty("object")&&(a.target=a.object);if(a.hasOwnProperty("actor")){if(typeof a.actor.objectType=="undefined"||a.actor.objectType==="Person")a.actor.objectType="Agent";a.actor.objectType==="Agent"?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):a.actor.objectType==="Group"&&(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor))}if(a.hasOwnProperty("authority")){if(typeof a.authority.objectType=="undefined"||a.authority.objectType==="Person")a.authority.objectType="Agent";a.authority.objectType==="Agent"?a.authority instanceof TinCan.Agent?this.authority=a.authority:this.authority=new TinCan.Agent(a.authority):a.authority.objectType==="Group"&&(a.actor instanceof TinCan.Group?this.authority=a.authority:this.authority=new TinCan.Group(a.authority))}a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb)),a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||a.target instanceof TinCan.StatementRef?this.target=a.target:(typeof a.target.objectType=="undefined"&&(a.target.objectType="Activity"),a.target.objectType==="Activity"?this.target=new TinCan.Activity(a.target):a.target.objectType==="Agent"?this.target=new TinCan.Agent(a.target):a.target.objectType==="Group"?this.target=new TinCan.Group(a.target):a.target.objectType==="SubStatement"?this.target=new TinCan.SubStatement(a.target):a.target.objectType==="StatementRef"?this.target=new TinCan.StatementRef(a.target):this.log("Unrecognized target type: "+a.target.objectType))),a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result)),a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));for(c=0;c<d.length;c+=1)a.hasOwnProperty(d[c])&&a[d[c]]!==null&&(this[d[c]]=a[d[c]]);b.doStamp&&this.stamp()},toString:function(a){return this.log("toString"),(this.actor!==null?this.actor.toString(a):"")+" "+(this.verb!==null?this.verb.toString(a):"")+" "+(this.target!==null?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var b={},c=["id","timestamp"],d=["actor","verb","result","context","authority"],e;a=a||TinCan.versions()[0];for(e=0;e<c.length;e+=1)this[c[e]]!==null&&(b[c[e]]=this[c[e]]);for(e=0;e<d.length;e+=1)this[d[e]]!==null&&(b[d[e]]=this[d[e]].asVersion(a));return this.target!==null&&(b.object=this.target.asVersion(a)),(a==="0.9"||a==="0.95")&&this.voided!==null&&(b.voided=this.voided),a==="0.9"&&this.inProgress!==null&&(b.inProgress=this.inProgress),b},stamp:function(){this.log("stamp"),this.id===null&&(this.id=TinCan.Utils.getUUID()),this.timestamp===null&&(this.timestamp=TinCan.Utils.getISODateString(new Date))}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.StatementsResult=function(a){this.log("constructor"),this.statements=null,this.more=null,this.init(a)};a.prototype={LOG_SRC:"StatementsResult",log:TinCan.prototype.log,init:function(a){this.log("init"),a=a||{},a.hasOwnProperty("statements")&&(this.statements=a.statements),a.hasOwnProperty("more")&&(this.more=a.more)}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c,d=[],e,f;try{c=JSON.parse(b)}catch(g){a.prototype.log("fromJSON - JSON.parse error: "+g)}if(c){for(f=0;f<c.statements.length;f+=1){try{e=new TinCan.Statement(c.statements[f],4)}catch(h){a.prototype.log("fromJSON - statement instantiation failed: "+h+" ("+JSON.stringify(c.statements[f])+")"),e=new TinCan.Statement({id:c.statements[f].id},4)}d.push(e)}c.statements=d}return new a(c)}}(),function(){"use strict";var a=TinCan.State=function(a){this.log("constructor"),this.id=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(a)};a.prototype={LOG_SRC:"State",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"],d;a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]]);this.updated=!1}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.ActivityProfile=function(a){this.log("constructor"),this.id=null,this.activity=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(a)};a.prototype={LOG_SRC:"ActivityProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"],d;a=a||{},a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]]);this.updated=!1}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var a=TinCan.AgentProfile=function(a){this.log("constructor"),this.id=null,this.agent=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(a)};a.prototype={LOG_SRC:"AgentProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"],d;a=a||{},a.hasOwnProperty("agent")&&(a.agent instanceof TinCan.Agent?this.agent=a.agent:this.agent=new TinCan.Agent(a.agent));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&a[c[b]]!==null&&(this[c[b]]=a[c[b]]);this.updated=!1}},a.fromJSON=function(b){a.prototype.log("fromJSON");var c=JSON.parse(b);return new a(c)}}(),function(){"use strict";var LOG_SRC="Environment.Browser",nativeRequest,xdrRequest,requestComplete,__delay,env={},log=TinCan.prototype.log;if(typeof window=="undefined"){log("'window' not defined",LOG_SRC);return}window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(a){var b="",c,d;if(a instanceof Object){if(a.constructor===Array){for(c=0;c<a.length;c+=1)b+=this.stringify(a[c])+",";return"["+b.substr(0,b.length-1)+"]"}if(a.toString!==Object.prototype.toString)return'"'+a.toString().replace(/"/g,"\\$&")+'"';for(d in a)a.hasOwnProperty(d)&&(b+='"'+d.replace(/"/g,"\\$&")+'":'+this.stringify(a[d])+",");return"{"+b.substr(0,b.length-1)+"}"}return typeof a=="string"?'"'+a.replace(/"/g,"\\$&")+'"':String(a)}}),Date.now||(Date.now=function(){return+(new Date)}),env.hasCORS=!1,env.useXDR=!1,typeof XMLHttpRequest!="undefined"&&typeof (new XMLHttpRequest).withCredentials!="undefined"?env.hasCORS=!0:typeof XDomainRequest!="undefined"&&(env.hasCORS=!0,env.useXDR=!0),requestComplete=function(a,b,c){log("requestComplete: "+c.finished+", xhr.status: "+a.status,LOG_SRC);var d,e,f;typeof a.status=="undefined"?f=c.fakeStatus:f=a.status===1223?204:a.status;if(!!c.finished)return d;c.finished=!0,e=b.ignore404&&f===404;if(!(f>=200&&f<400||e))return d={err:f,xhr:a},f===0?log("[warning] There was a problem communicating with the Learning Record Store. Aborted, offline, or invalid CORS endpoint ("+f+")",LOG_SRC):log("[warning] There was a problem communicating with the Learning Record Store. ("+f+" | "+a.responseText+")",LOG_SRC),b.callback&&b.callback(f,a),d;if(!b.callback)return d={err:null,xhr:a},d;b.callback(null,a)},nativeRequest=function(a,b,c){log("sendRequest using XMLHttpRequest",LOG_SRC);var d=this,e,f,g=[],h,i={finished:!1,fakeStatus:null},j=typeof c.callback!="undefined";log("sendRequest using XMLHttpRequest - async: "+j,LOG_SRC);for(f in c.params)c.params.hasOwnProperty(f)&&g.push(f+"="+encodeURIComponent(c.params[f]));g.length>0&&(a+="?"+g.join("&")),typeof XMLHttpRequest!="undefined"?e=new XMLHttpRequest:e=new ActiveXObject("Microsoft.XMLHTTP"),e.open(c.method,a,j);for(f in b)b.hasOwnProperty(f)&&e.setRequestHeader(f,b[f]);typeof c.data!="undefined"&&(c.data+=""),h=c.data,j&&(e.onreadystatechange=function(){log("xhr.onreadystatechange - xhr.readyState: "+e.readyState,LOG_SRC),e.readyState===4&&requestComplete.call(d,e,c,i)});try{e.send(h)}catch(k){log("sendRequest caught send exception: "+k,LOG_SRC)}return j?e:requestComplete.call(this,e,c,i)},xdrRequest=function(a,b,c){log("sendRequest using XDomainRequest",LOG_SRC);var d=this,e,f=[],g,h,i,j={finished:!1,fakeStatus:null};a+="?method="+c.method;for(h in c.params)c.params.hasOwnProperty(h)&&f.push(h+"="+encodeURIComponent(c.params[h]));for(h in b)b.hasOwnProperty(h)&&f.push(h+"="+encodeURIComponent(b[h]));c.data!==null&&f.push("content="+encodeURIComponent(c.data)),g=f.join("&"),e=new XDomainRequest,e.open("POST",a),c.callback?(e.onload=function(){j.fakeStatus=200,requestComplete.call(d,e,c,j)},e.onerror=function(){j.fakeStatus=400,requestComplete.call(d,e,c,j)},e.ontimeout=function(){j.fakeStatus=0,requestComplete.call(d,e,c,j)}):(e.onload=function(){j.fakeStatus=200},e.onerror=function(){j.fakeStatus=400},e.ontimeout=function(){j.fakeStatus=0}),e.onprogress=function(){},e.timeout=0;try{e.send(g)}catch(k){log("sendRequest caught send exception: "+k,LOG_SRC)}if(!c.callback){i=1e4+Date.now(),log("sendRequest - until: "+i+", finished: "+j.finished,LOG_SRC);while(Date.now()<i&&j.fakeStatus===null)__delay();return requestComplete.call(d,e,c,j)}return e},TinCan.LRS.prototype._initByEnvironment=function(a){log("_initByEnvironment",LOG_SRC);var b,c,d,e;a=a||{},this._makeRequest=nativeRequest,b=this.endpoint.toLowerCase().match(/([A-Za-z]+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/);if(b===null)throw log("[error] LRS invalid: failed to divide URL parts",LOG_SRC),{code:4,mesg:"LRS invalid: failed to divide URL parts"};d=location.port,c=location.protocol.toLowerCase()===b[1],d===""&&(d=location.protocol.toLowerCase()==="http:"?"80":location.protocol.toLowerCase()==="https:"?"443":""),e=!c||location.hostname.toLowerCase()!==b[2]||d!==(b[3]!==null&&typeof b[3]!="undefined"&&b[3]!==""?b[3]:b[1]==="http:"?"80":b[1]==="https:"?"443":"");if(e)if(env.hasCORS){if(env.useXDR&&c)this._makeRequest=xdrRequest;else if(env.useXDR&&!c){if(!a.allowFail)throw log("[error] LRS invalid: cross domain request for differing scheme in IE with XDR",LOG_SRC),{code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE with XDR"};log("[warning] LRS invalid: cross domain request for differing scheme in IE with XDR (allowed to fail)",LOG_SRC)}}else{if(!a.allowFail)throw log("[error] LRS invalid: cross domain requests not supported in this browser",LOG_SRC),{code:1,mesg:"LRS invalid: cross domain requests not supported in this browser"};log("[warning] LRS invalid: cross domain requests not supported in this browser (allowed to fail)",LOG_SRC)}},__delay=function(){var a=new XMLHttpRequest,b=window.location+"?forcenocache="+TinCan.Utils.getUUID();a.open("GET",b,!1),a.send(null)}}();var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.$super.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return f.create(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,a=a.sigBytes,c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return f.create(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,a=a.sigBytes,c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return f.create(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=f.create(),this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g),h=b?a.ceil(h):a.max((h|0)-this._minBufferSize,0),b=h*g,e=a.min(4*b,e);if(b){for(var i=0;i<b;i+=g)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return f.create(i,e)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=k.extend({init:function(){this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize(),this._hash},clone:function(){var a=k.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:16,_createHelper:function(a){return function(b,c){return a.create(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return l.HMAC.create(a,c).finalize(b)}}});var l=c.algo={};return c}(Math);(function(){var a=CryptoJS,b=a.lib,c=b.WordArray,b=b.Hasher,d=[],e=a.algo.SHA1=b.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,e=c[0],f=c[1],g=c[2],i=c[3],j=c[4],k=0;80>k;k++){if(16>k)d[k]=a[b+k]|0;else{var l=d[k-3]^d[k-8]^d[k-14]^d[k-16];d[k]=l<<1|l>>>31}l=(e<<5|e>>>27)+j+d[k],l=20>k?l+((f&g|~f&i)+1518500249):40>k?l+((f^g^i)+1859775393):60>k?l+((f&g|f&i|g&i)-1894007588):l+((f^g^i)-899497514),j=i,i=g,g=f<<30|f>>>2,f=e,e=l}c[0]=c[0]+e|0,c[1]=c[1]+f|0,c[2]=c[2]+g|0,c[3]=c[3]+i|0,c[4]=c[4]+j|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process()}});a.SHA1=b._createHelper(e),a.HmacSHA1=b._createHmacHelper(e)})(),function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=a.enc,e=d.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp();var e=[];for(var f=0;f<c;f+=3){var g=b[f>>>2]>>>24-f%4*8&255,h=b[f+1>>>2]>>>24-(f+1)%4*8&255,i=b[f+2>>>2]>>>24-(f+2)%4*8&255,j=g<<16|h<<8|i;for(var k=0;k<4&&f+k*.75<c;k++)e.push(d.charAt(j>>>6*(3-k)&63))}var l=d.charAt(64);if(l)while(e.length%4)e.push(l);return e.join("")},parse:function(a){a=a.replace(/\s/g,"");var b=a.length,d=this._map,e=d.charAt(64);if(e){var f=a.indexOf(e);f!=-1&&(b=f)}var g=[],h=0;for(var i=0;i<b;i++)if(i%4){var j=d.indexOf(a.charAt(i-1))<<i%4*2,k=d.indexOf(a.charAt(i))>>>6-i%4*2;g[h>>>2]|=(j|k)<<24-h%4*8,h++}return c.create(g,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}();
